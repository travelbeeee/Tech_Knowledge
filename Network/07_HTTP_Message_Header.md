# HTTPNetwork_Message_Header

### 1) HTTP 헤더 필드

HTTP 프로토콜의 리퀘스트와 리스폰스에는 반드시 메시지 헤더가 포함되어있습니다. 메시지 헤더에는 클라이언트나 서버가 리퀘스트나 리스폰스를 처리하기 위한 모든 정보가 들어가있습니다.

`헤더필드 명 : 필드 값`  구조로 되어있고, HTTP 헤더는 여러 개의 헤더 필드를 가질 수 있고, 필드는 여러 개의 필드 값을 가질 수 있습니다.

> HTTP 헤더 필드가 중복된 경우는 어떻게 될까
>
> HTTP 메시지 헤더 중에 같은 헤더 필드 명이 두 개 이상 있다면 브라우저에 따라 다르게 동작을 한다.

<br>

### 2) HTTP 헤더 필드 종류

HTTP 헤더 필드는 크게 4종류로 분류된다.

- 일반적 헤더 필드(General Header Fields)

  : 리퀘스트 메시지와 리스폰스 메시지 둘 다 사용되는 헤더

- 리퀘스트 헤더 필드(Request Header Fields)

  : 클라이언트 측에서 서버 측으로 송신된 리퀘스트 메시지에 사용되는 헤더로 리퀘스트의 부가적 정보와 클라이언트의 정보, 리스폰스의 콘텐츠에 관한 우선 순위 등을 부가합니다.

- 리스폰스 헤더 필드(Response Header Fields)

  : 서버 측에서 클라이언트 측으로 송신한 리스폰스 메시지에 사용되는 헤더로 리스폰스의 정보와 서버의 정보, 클라이언트의 추가 정보 요구 등을 부가합니다.

- 엔티티 헤더 필드(Entity Header Fields)

  : 리퀘스트 메시지와 리스폰스 메시지에 포함된 엔티티에 사용되는 헤더로 콘텐츠 갱신 시간 등의 엔티티에 관한 정보를 부가합니다.

<br>

### 3) 일반적 헤더 필드

- ##### Cache-Control

  : Cache-Control 헤더는 디렉티브라 불리는 명령을 사용하여 캐싱 동작을 지정합니다.

  - **Cache-Control: public**

    : Public 디렉티브가 사용되는 경우, 다른 유저에게도 돌려줄 수 있는 캐시를 해도 좋다는 것을 명시적으로 나타냅니다.

  - **Cache-Control: private**

    : Private 디렉티브가 사용되는 경우, 리스폰스는 특정 유저만을 대상으로 하고 있다는 것을 나타냅니다.

  - **Cache-Control: no-cache**

    : no-cache 디렉티브는 캐시로부터 오래된 리소스가 반환되는 것을 막기 위해 사용됩니다. 

    클라이언트의 리퀘스트로 no-cache 디렉티브가 사용된 경우, 캐시된 리스폰스를 클라이언트가 받아 들이지 않음을 나타내고, 중간 캐시 서버가 오리진 서버까지 리퀘스트를 전송해야 합니다.

    서버의 리스폰스에 no-cache 디렉티브가 사용된 경우, 캐시 서버는 리소스를 저장할 수 없습니다. 오리진 서버는 캐시 서버가 이후의 리퀘스트에서 리소스의 유효성을 재확인하지 않고는 그 리스폰스를 사용하지 못하도록 합니다.

  - **Cache-Control: no-store**

    : no-store 디렉티브가 사용된 경우, 리퀘스트 혹은 리스폰스에 기밀 정보가 포함되어 있음을 나타냅니다. 그렇기 때문에 캐시는 로컬 스토리지에 저장을 해서는 안되도록 지정합니다.

  - **Cache-Control: s-maxage**

    : s-maxage 디렉티브는 max-age 디렉티브와 동일한데 다른 점을 여러 유저가 이용할 수 있는 공유 캐시 서버에만 적용됩니다.

    또, s-maxage 디렉티브가 사용되는 경우, Expires 헤더 필드와 max-age 디렉티브는 무시됩니다.

  - **Cache-Control: max-age**

    : 클라이언트의 리퀘스트로 max-age 디렉티브가 사용되었다면, 지정되었던 값보다 새로운 경우에는 캐시되었던 리소스를 받아들일 수 있습니다. 리스폰스에서 max-age 디렉티브가 사용되었다면 캐시 서버가 유효성의 재확인을 하지 않고 리소스를 캐시에 보존해 두는 최대 시간을 나타냅니다.

    > HTTP/1.1 캐시 서버는 동시에 Expires 헤더 필드가 달린 경우에는 max-age 디렉티브가 우선순위를 가져가고, HTTP/1.0 캐시 서버는 Expires 헤더 필드가 우선 순위를 가져간다.

- ##### Connection

  : Connection 헤더 필드는 프록시에 더 이상 접속하지 않는 헤더 필드를 지정하고 지속적 접속을 관리합니다.

  ex) `Connection: Upgrade` 는 Upgrade 헤더 필드를 더 이상 프록시에 전달하지 말라는 뜻입니다.

  또, HTTP/1.1 에서는 지속접 접속이 디폴트로 되어있어서 `Connection: Close` 를 통해 지속적 접속을 끊을 수 있습니다.

- ##### Date

  : Date 헤더 필드는 HTTP 메시지를 생성한 날짜를 나타냅니다.

- ##### Pragma

  : Pragma 헤더 필드는 HTTP/1.1 보다 오래된 버전에서 캐시를 제어하는 필드입니다.

  `Pragma: no-cache` 만 지정 가능합니다.

- ##### Trailer

  : Trailer 헤더 필드는 메시지 바디의 뒤에 기술되어 있는 헤더 필드를 미리 전달할 수 있습니다. HTTP/1.1에 구현되어 있는 `청크 전송 인코딩`을 사용하고 있는 경우에 사용 가능합니다.

- ##### Upgrade

  : Upgrade 헤더 필드는 HTTP 및 다른 프로토콜의 새로운 버전이 통신에 이용되는 경우에 사용됩니다.

- ##### Via

  : Via 헤더 필드는 클라이언트와 서버 간의 리퀘스트 혹은 리스폰스 메시지의 경로를 알기 위해서 사용됩니다.

<br>

### 4) 리퀘스트 헤더 필드

- ##### Accept

  : Accept 헤더 필드는 유저 에이전트에 처리할 수 있는 미디어 타입과 미디어 타입의 상대적인 우선 순위를 전달하기 위해서 사용됩니다.

  `Accept: text/html, text/plain, text/css, image/jpeg, video/mpeg`

- ##### Accept-Charset

  : Accept-Charset 헤더 필드는 유저 에이전트에서 처리할 수 있는 문자셋으로, 문자셋의 상대적인 우선 순위를 전달하기 위해서 사용됩니다. 한 번에 여러 개를 지정할 수 있고, 상대적 우선 순위를 표시해 서버 구동형 네고시에이션에 이용됩니다.

  `Accept-Charset: iso-8859-5, unicode-1-1:q+0.8`

- ##### Accept-Encoding

  : Accept-Encoding 헤더 필드는 유저 에이전트가 처리할 수 있는 콘텐츠 코딩과 콘텐츠 코딩의 상대적인 우선 순위를 전달하기 위해서 사용됩니다. 

  `Accept-Encoding: gzip, deflate`

- ##### Accept-Language

  : Accept-Language 헤더 필드는 유저 에이전트가 처리할 수 있는 자연어의 세트와 상대적인 우선 순위를 전달하기 위해서 사용됩니다.

  `Accept-Language: ko-kr, en-us;q=0.7,en;q=0.3`

- ##### Authorization

  : Authorization 헤더 필드는 유저 에이전트의 인증 정보를 전달하기 위해서 사용됩니다.

- ##### Expect

  : Expect 헤더 필드는 클라이언트가 서버에 특정 동작 요구를 전달하기 위해서 사용합니다. 기대하고 있는 요구에 서버가 응답하지 못해서 에러가 발생하는 경우에는 `417 Expectation Failed`를 반환합니다.

- ##### From

  : From 헤더 필드는 유저 에이전트를 사용하고 있는 유저의 메일 주소를 전달합니다. 기본적으로는 검색 엔진 등의 에이전트 책임자에게 연락처 메일 주소를 나타내는 목적으로 사용됩니다. ( 무슨 일 있으면 여기로 연락하라고 클라이언트가 보내는 것 ! )

- ##### Host

  : Host 헤더 필드는 리퀘스트한 리소스의 인터넷 호스트와 포트 번호를 전달합니다. **HTTP/1.1 에서 유일한 필수 헤더 필드로 가상 호스트 구조 때문에 항상 필요합니다.**

- ##### If-Match

  : If-Match 헤더 필드는 조건부 리퀘스트의 하나로 서버 상의 리소스를 특정 하기 위해서 엔티티 태그 값을 전달합니다. If-Match 필드 값과 리소스의 엔티티 태그 값이 일치한 경우에만 리퀘스트를 받아들일 수 있습니다.

- ##### If-Modified-Since

  : If-Modified-Since 헤더 필드는 필드 값에 지정된 날짜 이후에 갱신된 리소스라면 서버에서 리퀘스트를 받아들입니다.

- ##### If-None-Match

  : If-None-Match 헤더 필드는 조건부 리퀘스트의 하나로 If-Match 헤더 필드와 반대로 동작합니다.

- ##### If-Range

  : If-Range 헤더 필드는 조건부 리퀘스트의 하나로 If-Range로 지정한 필드값과 지정한 리소스의 ETag 값 혹은 날짜가 일치하면 Range 리퀘스트로서 처리하고 싶다는 것을 전달합니다.

  `GET / If-Match: "123456" Range: 5001-10000` 는 "123456" ETag 값과 일치하는 리소스의 5001-10000 범위를 주세요! 라는 뜻이다.

- ##### If-Unmodified-Since

  : If-Unmodified-Since 헤더 필드는 If-Modified-Since 헤더 필드와 반대로 동작합니다.

- ##### Max-Forwards

  : Max-Forwards 헤더 필드는 TRACE 혹은 OPTIONS 메소드에 의한 리퀘스트를 할 때에 전송해도 좋은 서버 수의 최대치를 저장합니다.

- ##### Proxy-Authorization

  : Proxy-Authorization 헤더 필드는 프록시 서버에서의 인증 요구를 받아들인 때에 인증에 필요한 클라이언트의 정보를 전달합니다.

- ##### Range

  : Range 헤더 필드는 리소스의 일부분만 취득한 Range 리퀘스트를 할 때 지정 범위를 전달합니다.

<br>

### 5) 리스폰스 헤더 필드

- ##### Accept-Ranges

  : Accept-Ranges 헤더 필드는 서버가 리소스의 일부분만 지정해서 취득할 수 있는 Range 리퀘스트를 접수할 수 있는지 여부를 전달합니다. 수신 가능한 경우에는 `bytes`, 수신 불가능한 경우에는 `none` 을 필드 값으로 설정합니다.

- ##### Age

  : Age 헤더 필드는 얼마나 오래 전에 오리진 서버에서 리스폰스가 생성되었는지를 전달합니다. 필드 값의 단위는 초입니다.

- ##### ETag

  : ETag 헤더 필드는 엔티티 태그라고 불리며 특정 버전의 리소스를 식별하는 식별자입니다. 서버가 리소스마다 ETag 값을 할당하고, 리소스가 갱신되면 ETag 값도 갱신됩니다. ( 예를 들어, 같은 페이지지만 한국어 버전과 영어 버전은 다른 리소스!)

  > 강한 ETag vs 약한 ETag
  >
  > 강한 ETag 값은 엔티티가 아주 조금 다르더라도 반드시 값이 변하고, 약한 ETag 값은 리소스가 같다는 것만을 나타냅니다.

- ##### Location

  : Location 헤더 필드는 리스폰스의 수신자에 대해서 Request-URI 이외의 리소스 액세스를 유도하는 경우에 사용됩니다. ( 기본적으로, "3xx : Redirect" 리스폰스에 대해서 리다이렉트 할 곳의 URI를 기술합니다. )

- ##### Retry-After

  : Retry-After 헤더 필드는 클라이언트가 일정 시간 후에 리퀘스트를 다시 시행해야 하는지를 전달합니다.

- ##### Server

  : Server 헤더 필드는 서버에 설치되어 있는 HTTP 서버의 소프트웨어를 전달합니다.

- ##### Vary

  : Vary 헤더 필드는 캐시를 컨트롤하기 위해서 사용합니다. 오리진 서버가 프록시 서버에 로컬 캐시를 사용하는 방법에 대한 지시를 전달합니다.

- ##### WWW-Authenticate

  : WWW-Authenticate 헤더 필드는 HTTP 액세스 인증에 사용되는데 Request-URI에 지정했던 리로스에 저굥ㅇ할 수 있는 인증 스키마와 파라미터를 나타내는 challenge를 전달합니다.

<br>

### 6) 엔티티 헤더 필드

- ##### Allow

  : Allow 헤더 필드는 Request-URI에 지정된 리소스가 제공하는 메소드를 알려줍니다.

  ```
  Allow: GET, HEAD --> 우리 서버에서 사용 가능한 건 GET / HEAD 메소드 뿐이야!
  ```

- ##### Content-Encoding

  : Content-Encoding 헤더 필드는 서버가 엔티티 바디에 대해서 실시한 콘텐츠 코딩 형식을 전달합니다. ( 서버가 이 형식으로 압축해뒀으니깐, 이후 일은 잘 부탁해! 라는 뜻 )

- ##### Content-Language

  : Content-Language 헤더 필드는 엔티티 바디에 사용된 자연어를 전달합니다.

  ```
  Content-Language: en --> 이 리소스는 영어야!
  ```

- ##### Content-Length

  : Content-Length 헤더 필드는 엔티티 바디의 크기를 전달합니다.

- ##### Content-Location

  : Content-Location 헤더 필드는 메시지 바디에 대응하는 URI를 전달합니다. Location 헤더 필드와 달리 메시지 바디로 반환된 리소스의 URI를 나타냅니다.

- ##### Content-Range

  : Content-Range 헤더 필드는 범위를 지정해서 일부분만을 리퀘스트하는 Range 리퀘스트에 대해서 리스폰스를 할 때에 사용됩니다.

- ##### Content-Type

  : Content-Type 헤더 필드는 엔티티 바디에 포함되는 오브젝트의 미디어 타입을 전달합니다.

- ##### Expires

  : Expires 헤더 필드는 리소스의 유효 기한 날짜를 전달합니다.

- ##### Last-Modified

  : Last-Modified 헤더 필드는 리소스가 마지막으로 갱신되었던 날짜 정보를 전달합니다. 기본적으로는 Request-URI 가 지정된 리소스가 갱신되었던 날짜가 됩니다.

<br>

### 7) 쿠키를 위한 헤더필드

쿠키란 하이퍼 텍스트의 기록서(HTTP)의 일종으로서 사용자가 어떠한 웹사이트를 방문할 경우 그 사이트가 사용하고 있는 서버를 통해 인터넷 사용자의 컴퓨터에 설치되는 작은 기록 정보 파일을 일컫는다. 서버와 클라이언트 간의 상태를 관리하는 쿠키는 HTTP/1.1 사양에 포함된 것은 아니지만 웹 사이트에서 널리 사용되고 있습니다. 현재 사용하는 쿠키의 사양서는 넷스케이프의 개발자였던 루 몬툴리가 고안한 사양을 근간으로 확장한 것입니다. 

- ##### Set-Cookie

  : 서버가 클라이언트에 대해서 상태 관리를 시작할 때 사용하는 헤더필드로 필드 값에는 다음과 같은 정보가 기술됩니다.

  - Expires 속성

    : Expires 속성은 브라우저가 쿠키를 송출할 수 있는 유효 기한을 지정합니다. Expires 속성을 생략한 경우에는 브라우저 세션이 유지되고 있는 동안만 유효하게 됩니다.

  - Path 속성

    : Path 속성은 쿠키를 송출하는 범위를 특정 디렉토리에 한정할 수 있습니다.

  - Domain 속성

    : Domain 속성에 지정된 도메인 명은 후방 일치가 됩니다. 예를 들어, "example.com" 으로 지정했을 대 "www.example.com", "www2.example.com" 등에서도 쿠키가 송출됩니다.

  - Secure 속성

    : Secure 속성은 웹 페이지가 HTTPS에서 열렸을 때에만 쿠키 송출을 제한하기 위해서 지정합니다.

  - HttpOnly 속성

    : HttpOnly 속성은 자바스크립트를 경유해서 쿠키를 취득하지 못하도록 하는 쿠키의 확장 기능입니다.

- ##### Cookie

  : Cookie 헤더 필드는 클라이언트가 HTTP의 상태 관리 지원을 원할 때 서버로부터 수신한 쿠키를 이후의 리퀘스트에 포함해서 전달합니다.

  ```
  Cookie: status=enable
  ```

  