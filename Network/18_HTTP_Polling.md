# HTTP_Polling

 웹은 HTTP 프로토콜을 이용하기 때문에 `Connectionless`하므로 실시간으로 데이터를 통신할 수 없습니다. 따라서, 실시간으로 변하는 축구 중계 혹은 야구 중계, 주식 데이터 등은 브라우저에서 새롭게 요청을 보내 데이터를 받아와야합니다. 웹에서 양방향 통신을 위한 방법으로 크게 `Polling` 방식과 `WebSocket` 방식이 있습니다.  `Polling` 방식은 `WebSocket` 방식이 등장하기 이전에 사용하던 방식입니다. 

<br>

### 1) Polling

 클라이언트가 N초 간격으로 request를 서버에 계속 날려서 response를 전달받는 방식입니다. 간격이 작다면 request를 날리는 서버의 부담이 증가하고, 간격이 크다면 실시간성이 떨어진다는 문제가 있습니다. 요청을 주기적인 간격으로 보내며 클라이언트는 정보가 있든 없든 응답을 받는다. 구체적으로 말해, 정보가 있으면 서버는 그 정보를 송신하고 정보가 없으면 서버는 부정적인 응답을 반환하고 클라이언트는 연결을 닫는다.

<br>

### 2) Long Polling

 Polling 방식을 개선하기 위해 나온 방식입니다. 클라이언트가 서버에 HTTP Request를 요청하면, 서버는 대기하고 있다가 이벤트가 발생했을 때, 클라이언트에게 응답을 하는 방식이다. Polling 처럼 불필요한 요청에 계속 응답하는 것이 아니기 때문에 요청에 따른 커넥션 맺는 과정에서 발생하는 비용이 줄어든다. 하지만, 데이터 업데이트가 빈번해진다면 일반 Polling 방식과 차이가 없어집니다. 또, 다수의 클라이언트가 동시에 이벤트가 발생할 경우, 서버는 각 클라이언트에게 응답을 하게 되고, 그 다수의 클라이언트는 서버에게 곧바로 요청을 하기 때문에 이 순간 서버의 부담이 커진다.

<br>

### 3) WebSocket

 웹소켓은 서버와 클라이언트 간에 `Socket Connection`을 유지해서 언제든 양방향 통신 또는 데이터 전송이 가능하도록 하는 프로토콜입니다. WebSocket 프로토콜과 HTTP 프로토콜은 모두 Application Layer에 해당되는 프로토콜이고 TCP 프로토콜에 의존합니다. HTTP 프로토콜과 호환이 되는 프로토콜로, HTTP Upgrade Header를 통해 HTTP 프로토콜에서 WebSocket 프로토콜로 변경합니다. 이를 WebSocket Handshake라고 한다.

- 클라이언트가 서버로 `HTTP Upgrade` 요청을 보냅니다.
- 서버를 Upgrade를 할 수 있는 경우, `HTTP 101` 응답을 클라이언트에게 보내고, 서버와 클라이언트 사이의 커넥션을 웹 소켓 프로토콜로 Upgrade 합니다.
- 그 뒤부터는 HTTP 프로토콜이 아니라, WebSocket Protocol로 동작하게 됩니다.

 WebSocket은 브라우저만의 지원으로 사용할 수 없고, 웹서버도 또한 WebSocket 프로토콜을 지원해야합니다. 또, HTTP와 다르게 상태를 유지하는 `Stateful` 특징을 가지고 있으므로 부하가 발생할 수 있고, 비정상적으로 연결이 끊어졌을 때 적절한 대응을 해줘야한다.

