# Cookie 와 Session

`Cookie` 와 `Session` 의 등장 배경과 특징, 차이점을 정리해보겠습니다.

### 1) Cookie 와 Session 등장 배경

 HTTP 프로토콜은 `Connectionless`, `Stateless` 2가지 특징을 가지고 있습니다. 웹이 발전함에 따라 HTTP 프로토콜에서 데이터 유지가 필요한 상황들이 생겼습니다. 비회원 장바구니 기능이나 페이지를 이동해도 로그인이 유지되는 기능들은 모두 데이터 유지를 필요로 합니다. 따라서, 데이터 저장 기술인 `Cookie`와 `Session`이 등장하게 되었습니다.

<br>

### 2) Cookie ( 쿠키 )

  서버가 아니라 클라이언트에 정보를 저장하고 있는 방식입니다. 

- 사용자의 로컬에 키와 값이 들어있는 작은 데이터 파일을 저장하는 방식
  - 로컬 파일에 저장하기 때문에 빠르게 참조 가능 
- 300개까지 쿠키 저장이 가능하고, 하나의 도메인당 20개의 쿠키를 저장할 수 있습니다.  
- 따로 요청하지 않아도 브라우저가 `request` 시에 `request header`에 넣어서 자동으로 쿠키를 서버에 전송
  - 브라우저가 종료되더라도 유효 시간이 끝나지 않았다면 쿠키는 유지됩니다.
- 서버가 가지고 있는 것이 아니라 사용자에게 저장되기 때문에, 임의로 고치거나 지울 수 있고, 가로채기도 쉬워 보안이 취약
  - 쿠키에는 민감하거나 중요한 정보를 담으면 안된다.

<br>

###  3) Cookie ( 쿠키 ) 구성 요소

- 이름 : 각각의 쿠키를 구별하는 데 사용되는 이름
- 값 : 쿠키의 이름과 관련된 값
- 유효시간 : 쿠키의 유지시간
- 도메인 : 쿠키를 전송할 도메인
- 경로 : 쿠키를 전송할 요청 경로

<br>

### 3) Session ( 세션 )

 서버에 정보를 저장하고 있는 방식입니다. 

- 쿠키를 기반으로 동작하지만, 사용자 정보 파일을 서버 측에서 관리합니다. 
- 사용자에 대한 정보를 서버에 두기 때문에 쿠키보다 보안에 좋지만, 사용자가 많아질수록 서버 메모리를 많이 차지하게 되므로 성능 저하의 요인이 됩니다. 
- 저장한 세션마다 세션 ID를 부여하여 클라이언트에 쿠키로 저장해두고, `request`시에 쿠키로 세션 ID를 정보를 받아 세션 정보를 참조합니다. 
- 기본적으로 세션 ID는 웹 브라우저 당 1개씩 생성되어 웹 컨테이너에 저장되며 브라우저 종료시 세션은 만료됩니다.
- 로컬 파일을 바로 참조하는 쿠키보다 속도가 느립니다.

<br>

### 4) Cookie vs Session

- 저장 장소 
  - Cookie : 클라이언트
  - Session : 서버
- 저장 형태
  - Cookie : key와 value로 이루어진 test
  - Session : 서버가 허용하는 Object
- 보안
  - Cookie : 클라이언트에서 보관하므로 탈취가 쉽다.
  - Session : 서버에서 보관하므로 보안에 유리하다
- 속도
  - Cookie : 로컬 파일에 저장되므로 접근이 빠르다.
  - Session : 서버에서 관리하므로 쿠키에 비해 느리다.

<br>

### Q.  세션ID는 계속 일정한가요? 세션만료는 어디서 이루어지나요?  

 세션 ID는 브라우저마다 일정하게 주어지고, 세션이 만료되면 새로운 세션 ID가 주어집니다. 세션 만료는 브라우저 종료시에도 이루어지고, `session.invalidate()`로 서버에서 강제로 세션을 만료할 수도 있습니다. 

 (추측) 기한이 만료된 세션ID가 클라로부터 넘어오면 서버에서 세션을 만료시키지 않을까....??